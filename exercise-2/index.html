<!DOCTYPE html>
<html>

<head>
  <title>Todo list App</title>
  <link rel="stylesheet" type="text/css" href="myStyle.css" />
  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
</head>

<body>
  <div class="container">
    <h1 class="heading">TODO LIST</h1>
    <div class="todo">
      <div class="addTodo">
        <h3>Add Task</h3>
        <form>
          <input id="formTodo" type="text" name="name" required placeholder="Add your Item" />

          <button id="newTask" type="button">Add Task</button>

        </form>
      </div>
      <div class="list">
        <h3>To do Task</h3>
        <div class="addedTask">
          <!-- <button id="edit">Edit</button>
    <button id="deleteButton" type="button">Delete</button>  -->
          <!-- <button onclick="deleteBtn()">Delete</button> -->
        </div>
      </div>


    </div>

    <!-- 
    <form>
      <label id="new-task-label" for="new-task" style="display: block; margin: 0 0 20px">
        <b>Add Item</b>
      </label>
      <input id="new-task" type="text">
      <button>Add</button>
    </form> -->

    <!-- <h3>
      <b>Todo</b>
    </h3>
    <ul id="incomplete-tasks">
      <li>
        <input type="checkbox">
        <label>Pay Bills</label>
        <input type="text">
        <button class="edit">Edit</button>
        <button class="delete">Delete</button>
      <li class="editMode">
        <input type="checkbox">
        <label>Go Shopping</label>
        <input type="text" value="Go Shopping">
        <button class="edit">Save</button>
        <button class="delete">Delete</button>
      </li>
    </ul>  -->
<div class="completedTaskList">
    <h3>
      <b>Completed</b>
    </h3>
    <div id="completed-tasks">
      <!-- <li>
       
        <label>See the Doctor</label>
        <input type="text">
        <button class="edit">Edit</button>
        <button class="delete">Delete</button>
      </li> -->
    </div>
  </div>
  </div>

  <script type="text/javascript">
    const formTodo = document.getElementById('formTodo');
    const newTask = document.getElementById('newTask');
    const deleteButton = document.getElementById('deleteButton');
    const completedTaks = document.getElementById('completed-tasks')

    const addedTask = document.getElementsByClassName('addedTask')
    const list = document.querySelector('.list');
    const completedTaskList = document.querySelector('.completedTaskList');
    if (JSON.parse(localStorage.getItem('todoTasks')) !== null) {
      JSON.parse(localStorage.getItem('todoTasks')).map(todo => {
        const div = document.createElement("div");
        div.className = 'addedTask'
        const input = document.createElement("input");
        input.type = 'checkbox';
        input.name = 'itemCheck';
        input.id = todo.name;
        const deleteButton = document.createElement("button");
        const saveButton = document.createElement("button");
        // const editButton = document.createElement("button");
        // button.id = deleteBtn;
        deleteButton.innerText = "Delete";
        deleteButton.name = 'deleteTask';
        saveButton.innerText = "Save";
        saveButton.name = 'saveTask';
        // editButton.innerText = "Edit";
        const p = document.createElement("p");
        p.innerHTML = todo.name;
        div.append(input);
        div.append(p);
        div.append(deleteButton);
        div.append(saveButton);
        // div.append(editButton);
        list.append(div);
        console.log(div);

      });
    }
  
    // //removing items 
    //     var deleteTask = function (el) {
    //   var list = this.parentNode;
    //   var ul = list.parentNode;
    //   ul.removeChild(list);
    // };

  
    const tasks = document.querySelectorAll('input[name="itemCheck"]');
    const deleteMyTask = document.querySelectorAll('button[name="deleteTask"]');
    const saveMyTask = document.querySelectorAll('button[name="saveTask"]');

    for (let i = 0; i < tasks.length; i++) {

      deleteMyTask[i].addEventListener("click", function (e) {
        console.log(e.target);
        if (JSON.parse(localStorage.getItem('todoTasks')) !== null) {
          let taskLocal = [];
          JSON.parse(localStorage.getItem('todoTasks')).map(todo => {
            if (todo.id != e.target.id) {
              taskLocal.push(todo);
            }
          });
          localStorage.setItem('todoTasks', JSON.stringify(taskLocal));
          window.location.reload();
          alert('Do you want to delete this task?');
        }
      })
      saveMyTask[i].addEventListener("click", function (e) {
        // console.log(saveMyTask);
        // console.log(e.target);
        // const taskLocal =[];
        // if (JSON.parse(localStorage.getItem('todoTasks'))[JSON.parse(localStorage.getItem('todoTasks')).length - 1]) {
        //   let completedTasks = [];
        //   JSON.parse(localStorage.getItem('todoTasks')).map(todo => {
        //     if (todo.id == e.target.id) {
        //       completedTasks.push(todo);
        //     }
        //   });
        //   console.log(completedTasks);
        //   localStorage.setItem('todoTasks', JSON.stringify(completedTasks));
        //   window.location.reload();
        //   alert('Do you want to save this task?');
          
        // }
        const completedTaskList = document.querySelector('.completedTaskList');
        if (JSON.parse(localStorage.getItem('todoTasks')) !== null) {
      JSON.parse(localStorage.getItem('todoTasks')).map(todo => {
        const div = document.createElement("div");
        div.id = 'completed-tasks';
        const input = document.createElement("input");
        input.type = 'checkbox';
        input.name = 'itemCheck';

        input.id = todo.name;
        const deleteButton = document.createElement("button");
        // const saveButton = document.createElement("button");
        const editButton = document.createElement("button");
        // button.id = deleteBtn;
        deleteButton.innerText = "Delete";
        deleteButton.name = 'deleteTask';
        // saveButton.innerText = "Save";
        // saveButton.name = "saveTask";
        editButton.innerText = "Edit";
        const p = document.createElement("p");
        p.innerHTML = todo.name;
        div.append(input);
        div.append(p);
        div.append(deleteButton);
        // div.append(saveButton);
        div.append(editButton);
        completedTaskList.append(div);
        console.log(completedTaskList);

      });
    }
     
      })
    }
    // }

    newTask.onclick = function () {
      const task = formTodo.value;
      let taskList = [];
      let id = Id();
      function Id() {
        if (JSON.parse(localStorage.getItem('todoTasks')) === null || JSON.parse(localStorage.getItem('todoTasks')).length == 0) {
          return 1;
        } else {
          return JSON.parse(localStorage.getItem('todoTasks'))[JSON.parse(localStorage.getItem('todoTasks')).length - 1].id + 1;
        }
      };
      let item = {
        id: id,
        name: task
      };
      if (task == '') {
        alert('Please fill the task here!!');
      } else {
        console.log(item);
        // alert('hello');
        if (JSON.parse(localStorage.getItem('todoTasks')) === null) {
          taskList.push(item);
          localStorage.setItem('todoTasks', JSON.stringify(taskList));
          window.location.reload();

        } else {
          JSON.parse(localStorage.getItem('todoTasks')).map(todo => {
            taskList.push(todo);
          });
          taskList.push(item);
          localStorage.setItem('todoTasks', JSON.stringify(taskList));
          window.location.reload();

        }
      }
      // e.preventDefault();

    }
    //form submit

// window.onload=(e)=> {
// const formTodo = document.querySelector('.formTodo');
// formTodo.onsubmit = function(){

//     // e.preventDefault();
//     console.log("hello");
//     alert('hello');
// }
// }
  </script>
</body>

</html>